!function(t){var n={};function e(o){if(n[o])return n[o].exports;var s=n[o]={i:o,l:!1,exports:{}};return t[o].call(s.exports,s,s.exports,e),s.l=!0,s.exports}e.m=t,e.c=n,e.d=function(t,n,o){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:o})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(e.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var s in t)e.d(o,s,function(n){return t[n]}.bind(null,s));return o},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=0)}([function(t,n,e){"use strict";e.r(n);e(1)},function(t,n){const e="https://backend-09-server.herokuapp.com";let o=0,s=0,a=[];const r=document.getElementById("root"),i=document.createElement("form");i.innerHTML='\n<form>\n  <div class="form-row">\n    <div class="col-7">\n    <input class="form-control" placeholder="–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –∏–ª–∏ url" data-id="link">\n    </div>\n    <select class="col" data-id="type">\n            <option value="regular">–û–±—ã—á–Ω—ã–π</option>\n             <option value="image">–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ</option>\n             <option value="audio">–ê—É–¥–∏–æ</option>\n            <option value="video">–í–∏–¥–µ–æ</option>\n    </select>\n    <button class="btn btn-primary">–î–æ–±–∞–≤–∏—Ç—å</button>\n  </div>\n</form>\n',r.appendChild(i);const l=document.createElement("button");l.className="btn btn-primary btn-block mt-1",l.textContent="–ü–æ–∫–∞–∑–∞—Ç—å –Ω–æ–≤—ã–µ –∑–∞–ø–∏—Å–∏",l.style.display="none",l.addEventListener("click",t=>{fetch(`${e}/posts/${o}`).then(t=>{if(!t.ok)throw new Error(t.statusText);return t.json()}).then((function(t){o=0,a.unshift(...t.reverse()),b(u,a),l.style.display="none"})).catch(t=>{console.log(t)})}),r.appendChild(l);const c=i.querySelector("[data-id=link]"),d=i.querySelector("[data-id=type]");c.value=localStorage.getItem("content"),c.addEventListener("input",t=>{localStorage.setItem("content",t.currentTarget.value)}),null!==localStorage.getItem("type")&&(d.value=localStorage.getItem("type")),d.addEventListener("input",t=>{localStorage.setItem("type",t.currentTarget.value)}),i.addEventListener("submit",(function(t){t.preventDefault();const n={id:0,content:c.value,type:d.value};fetch(`${e}/posts`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then(t=>{if(!t.ok)throw new Error(t.statusText);return t.json()}).then(t=>{c.value="",d.value="regular",localStorage.clear(),a.unshift(t),o=t.id,b(u,a)}).catch(t=>{console.log(t)})}));const u=document.createElement("div");function b(t,n){t.innerHTML="";for(const o of n){const n=document.createElement("div");n.className="card mb-2","regular"===o.type?n.innerHTML=`\n                <div class="card-body">\n                    <div class="card-text">${o.content}</div>\n                    <button class="btn">‚ô° ${o.likes}</button>\n                    <button class="btn btn-primary" data-action="like">üëç</button>\n                    <button class="btn btn-danger" data-action="dislike">üëé</button>\n                    <button class="btn btn-light" data-action="delete">–£–¥–∞–ª–∏—Ç—å –ø–æ—Å—Ç</button>\n                </div>\n            `:"image"===o.type?n.innerHTML=`\n                <img src="${o.content}" class="card-img-top"></img>\n                <div class="card-body">\n                    <button class="btn">‚ô° ${o.likes}</button>\n                    <button class="btn btn-primary" data-action="like">üëç</button>\n                    <button class="btn btn-danger" data-action="dislike">üëé</button>\n                    <button class="btn btn-light" data-action="delete">–£–¥–∞–ª–∏—Ç—å –ø–æ—Å—Ç</button>\n                </div>\n            `:"audio"===o.type?n.innerHTML=`\n                <audio src="${o.content}" class="embed-responsive embed-responsive-21by9 card-img-top" controls></audio>\n                <div class="card-body">\n                    <button class="btn">‚ô° ${o.likes}</button>\n                    <button class="btn btn-primary" data-action="like">üëç</button>\n                    <button class="btn btn-danger" data-action="dislike">üëé</button>\n                    <button class="btn btn-light" data-action="delete">–£–¥–∞–ª–∏—Ç—å –ø–æ—Å—Ç</button>\n                </div>\n            `:"video"===o.type&&(n.innerHTML=`\n                <video src="${o.content}" class="embed-responsive embed-responsive-16by9 card-img-top" controls></video>\n                <div class="card-body">\n                    <button class="btn">‚ô° ${o.likes}</button>\n                    <button class="btn btn-primary" data-action="like">üëç</button>\n                    <button class="btn btn-danger" data-action="dislike">üëé</button>\n                    <button class="btn btn-light" data-action="delete">–£–¥–∞–ª–∏—Ç—å –ø–æ—Å—Ç</button>\n                </div>\n            `),n.querySelector("[data-action=delete]").addEventListener("click",(function(){fetch(`${e}/posts/${o.id}`,{method:"DELETE"}).then(t=>{if(!t.ok)throw new Error(t.statusText);return t.json()}).then(t=>{const n=a.findIndex(t=>t.id===o.id);a.splice(n,1),b(u,a)}).catch(t=>{console.log(t)})})),n.querySelector("[data-action=like]").addEventListener("click",(function(){fetch(`${e}/posts/${o.id}/likes`,{method:"POST"}).then(t=>{if(!t.ok)throw new Error(t.statusText);return t.json()}).then(t=>{const n=a.findIndex(t=>t.id===o.id);a[n].likes++,b(u,a)}).catch(t=>{console.log(t)})})),n.querySelector("[data-action=dislike]").addEventListener("click",(function(){fetch(`${e}/posts/${o.id}/likes`,{method:"DELETE"}).then(t=>{if(!t.ok)throw new Error(t.statusText);return t.json()}).then(t=>{const n=a.findIndex(t=>t.id===o.id);a[n].likes--,b(u,a)}).catch(t=>{console.log(t)})})),t.appendChild(n)}}r.appendChild(u),fetch(`${e}/posts/seenPosts/${s}`).then(t=>{if(!t.ok)throw new Error(t.statusText);return t.json()}).then((function(t){0!==t.length&&(t.length<5?a.push(...t.reverse()):(s=t[t.length-5].id,a.push(...t.reverse()),p.style.display="block"),b(u,a))})).catch(t=>{console.log(t)});const p=document.createElement("button");p.className="btn btn-primary btn-block mt-1",p.textContent="–ü–æ–∫–∞–∑–∞—Ç—å –µ—â–µ –ø–æ—Å—Ç—ã",p.style.display="none",p.addEventListener("click",(function(){fetch(`${e}/posts/seenPosts/${s}`).then(t=>{if(!t.ok)throw new Error(t.statusText);return t.json()}).then((function(t){0===t.length?p.style.display="none":(t.length<5?(s=t[t.length-1].id,a.push(...t.reverse()),p.style.display="none"):(s=t[t.length-5].id,a.push(...t.reverse()),p.style.display="block"),b(u,a))})).catch(t=>{console.log(t)})})),r.appendChild(p),setInterval(()=>{fetch(`${e}/posts/${o}`).then(t=>{if(!t.ok)throw new Error(t.statusText);return t.json()}).then((function(t){0===t.length?(console.log("–ù–æ–≤—ã—Ö –ø–æ—Å—Ç–æ–≤ –Ω–µ—Ç"),l.style.display="none"):0===o?(o=t[t.length-1].id,l.style.display="none"):l.style.display="block",console.log(t),console.log("firstSeenId = "+o)})).catch(t=>{console.log(t)})},3e3)}]);